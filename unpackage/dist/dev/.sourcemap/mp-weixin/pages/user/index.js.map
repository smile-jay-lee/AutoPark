{"version":3,"file":"index.js","sources":["pages/user/index.vue","../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9pbmRleC52dWU"],"sourcesContent":["<template>\r\n  <view class=\"page\">\r\n    <view class=\"profile-card\">\r\n      <view class=\"avatar\">\r\n        <u-avatar v-if=\"isLoggedIn && userInfo.avatar\" :src=\"userInfo.avatar\" size=\"large\"></u-avatar>\r\n      </view>\r\n      <view class=\"profile-info\">\r\n        <view class=\"greeting\">{{ isLoggedIn ? (userInfo.name || '微信用户') : '点击登录查看信息' }}</view>\r\n        <view class=\"subtext\">{{ isLoggedIn ? (userInfo.phone || '') : ' ' }}</view>\r\n      </view>\r\n      <view class=\"login-btn\" v-if=\"!isLoggedIn\" @click.stop=\"handleLogin\">\r\n        <text>注册/登录</text>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 统计数据区域 - 始终显示 -->\r\n    <view class=\"stats-section\">\r\n      <view class=\"stats-item\" @click=\"switchTab('reservations')\">\r\n        <view class=\"stats-value\">{{ stats.totalReservations }}</view>\r\n        <view class=\"stats-label\">总预约</view>\r\n      </view>\r\n      <view class=\"stats-item\" @click=\"switchTab('payments')\">\r\n        <view class=\"stats-value\">{{ stats.totalSpent }}</view>\r\n        <view class=\"stats-label\">累计消费</view>\r\n      </view>\r\n      <view class=\"stats-item\" @click=\"switchTab('completed')\">\r\n        <view class=\"stats-value\">{{ stats.completedReservations }}</view>\r\n        <view class=\"stats-label\">已完成</view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 筛选栏 - 始终显示 -->\r\n    <view class=\"filter-bar\">\r\n      <view v-for=\"item in tabs\" :key=\"item.value\" class=\"filter-item\" :class=\"{ active: activeTab === item.value }\"\r\n        @click=\"switchTab(item.value)\">\r\n        {{ item.label }}\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 列表区域 - 始终显示 -->\r\n    <scroll-view class=\"list\" scroll-y>\r\n      <!-- 预约记录视图 -->\r\n      <view\r\n        v-if=\"activeTab === 'reservations' || activeTab === 'all' || activeTab === 'confirmed' || activeTab === 'cancelled' || activeTab === 'completed'\">\r\n        <view v-if=\"filteredReservations.length === 0\" class=\"empty\">\r\n          <image class=\"empty-image\" src=\"/static/coolc/empty.png\"></image>\r\n          <view class=\"empty-text\">暂无相关预约记录</view>\r\n        </view>\r\n        <view v-for=\"item in filteredReservations\" :key=\"item.id\" class=\"reservation-card\">\r\n          <view class=\"card-header\">\r\n            <view class=\"lot-name\">{{ item.lotName }}</view>\r\n            <view class=\"status\" :class=\"'status-' + item.status\">{{ statusText(item.status) }}</view>\r\n          </view>\r\n          <view class=\"card-body\">\r\n            <view class=\"row\">\r\n              <text class=\"label\">预约日期</text>\r\n              <text class=\"value\">{{ item.reservationDate }}</text>\r\n            </view>\r\n            <view class=\"row\">\r\n              <text class=\"label\">到达时间</text>\r\n              <text class=\"value\">{{ item.arrivalTime }}</text>\r\n            </view>\r\n            <view class=\"row\">\r\n              <text class=\"label\">预约天数</text>\r\n              <text class=\"value\">{{ item.reservationDays }} 天</text>\r\n            </view>\r\n            <view class=\"row\">\r\n              <text class=\"label\">预付定金</text>\r\n              <text class=\"value\">￥{{ item.depositAmount }}</text>\r\n            </view>\r\n            <view class=\"row\" v-if=\"item.couponAmount && item.couponAmount > 0\">\r\n              <text class=\"label\">优惠券</text>\r\n              <text class=\"value\">￥{{ item.couponAmount }}</text>\r\n            </view>\r\n          </view>\r\n          <view class=\"card-footer\">\r\n            <u-button v-if=\"item.status === 'confirmed'\" size=\"mini\" plain shape=\"circle\" color=\"#3D7EFF\"\r\n              @click=\"cancelReservation(item.id)\">取消预约</u-button>\r\n            <u-button size=\"mini\" plain shape=\"circle\" color=\"#7A8499\" @click=\"viewDetail(item.id)\">查看详情</u-button>\r\n          </view>\r\n        </view>\r\n      </view>\r\n\r\n\r\n\r\n\r\n      <!-- 支付记录视图 -->\r\n      <view v-if=\"activeTab === 'payments'\">\r\n        <view v-if=\"paymentRecords.length === 0\" class=\"empty\">\r\n          <image class=\"empty-image\" src=\"/static/coolc/empty.png\"></image>\r\n          <view class=\"empty-text\">暂无支付记录</view>\r\n        </view>\r\n        <view v-for=\"item in paymentRecords\" :key=\"item.id\" class=\"payment-card\">\r\n          <view class=\"card-header\">\r\n            <view class=\"payment-title\">{{ item.title }}</view>\r\n            <view class=\"amount\">￥{{ item.amount }}</view>\r\n          </view>\r\n          <view class=\"card-body\">\r\n            <view class=\"row\">\r\n              <text class=\"label\">支付时间</text>\r\n              <text class=\"value\">{{ item.paymentTime }}</text>\r\n            </view>\r\n            <view class=\"row\">\r\n              <text class=\"label\">支付方式</text>\r\n              <text class=\"value\">{{ item.paymentMethod }}</text>\r\n            </view>\r\n            <view class=\"row\">\r\n              <text class=\"label\">交易单号</text>\r\n              <text class=\"value\">{{ item.transactionId }}</text>\r\n            </view>\r\n          </view>\r\n          <view class=\"card-footer\">\r\n            <view class=\"payment-status\" :class=\"'payment-' + item.status\">\r\n              {{ paymentStatusText(item.status) }}\r\n            </view>\r\n            <u-button v-if=\"item.status === 'success' && item.canRefund\" size=\"mini\" plain shape=\"circle\"\r\n              color=\"#FF5A5F\" @click=\"requestRefund(item.id)\">申请退款</u-button>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </scroll-view>\r\n\r\n    <!-- 设置菜单板块 - 始终显示 -->\r\n    <view class=\"settings-section\" @click=\"showSettings\">\r\n      <view class=\"settings-item\">\r\n        <u-icon name=\"setting\" size=\"28\" color=\"#3D7EFF\"></u-icon>\r\n        <text class=\"settings-text\">设置菜单</text>\r\n      </view>\r\n      <view class=\"arrow-icon\">\r\n        <u-icon name=\"arrow-right\" size=\"24\" color=\"#7A8499\"></u-icon>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 设置弹窗 -->\r\n    <u-popup :show=\"showSettingsPopup\" mode=\"bottom\" :round=\"true\" @close=\"showSettingsPopup = false\">\r\n      <view class=\"settings-popup\">\r\n        <view class=\"popup-header\">\r\n          <view class=\"popup-title\">设置</view>\r\n          <u-icon name=\"close\" @click=\"showSettingsPopup = false\"></u-icon>\r\n        </view>\r\n        <view class=\"settings-list\">\r\n          <view class=\"settings-item\" @click=\"goToProfile\">\r\n            <view class=\"settings-label\">个人信息</view>\r\n            <u-icon name=\"arrow-right\" size=\"24\" color=\"#7A8499\"></u-icon>\r\n          </view>\r\n          <view class=\"settings-item\" @click=\"goToPrivacy\">\r\n            <view class=\"settings-label\">隐私设置</view>\r\n            <u-icon name=\"arrow-right\" size=\"24\" color=\"#7A8499\"></u-icon>\r\n          </view>\r\n          <view class=\"settings-item\" @click=\"goToAbout\">\r\n            <view class=\"settings-label\">关于我们</view>\r\n            <u-icon name=\"arrow-right\" size=\"24\" color=\"#7A8499\"></u-icon>\r\n          </view>\r\n          <view class=\"settings-item\" @click=\"goToAdmin\">\r\n            <view class=\"settings-label\">管理员入口</view>\r\n            <u-icon name=\"arrow-right\" size=\"24\" color=\"#7A8499\"></u-icon>\r\n          </view>\r\n          <view class=\"settings-item\" @click=\"logout\">\r\n            <view class=\"settings-label\">退出登录</view>\r\n            <u-icon name=\"arrow-right\" size=\"24\" color=\"#7A8499\"></u-icon>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </u-popup>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getReservations,\r\n  updateReservationStatus,\r\n  adjustParkingLotQuota,\r\n  getPaymentRecords,\r\n  requestRefund as requestRefundApi\r\n} from '@/pages/util/mockData'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      isLoggedIn: false, // 登录状态\r\n      tabs: [\r\n        { label: '全部', value: 'all' },\r\n        { label: '预约记录', value: 'reservations' },\r\n        { label: '支付记录', value: 'payments' },\r\n        { label: '待入场', value: 'confirmed' },\r\n        { label: '已完成', value: 'completed' },\r\n        { label: '已取消', value: 'cancelled' }\r\n      ],\r\n      activeTab: 'all',\r\n      reservations: [],\r\n      paymentRecords: [],\r\n      userInfo: {\r\n        name: '',\r\n        phone: '',\r\n        avatar: ''\r\n      },\r\n      stats: {\r\n        totalReservations: 0,\r\n        totalSpent: 0,\r\n        completedReservations: 0\r\n      },\r\n      showSettingsPopup: false\r\n    }\r\n  },\r\n  computed: {\r\n    filteredReservations() {\r\n      if (this.activeTab === 'all' || this.activeTab === 'reservations') {\r\n        return this.reservations\r\n      }\r\n      return this.reservations.filter((item) => item.status === this.activeTab)\r\n    }\r\n  },\r\n  onShow() {\r\n    this.checkLoginStatus()\r\n    // 始终加载数据，未登录时显示空数据\r\n    this.loadData()\r\n    if (this.isLoggedIn) {\r\n      this.loadUserInfo()\r\n    }\r\n    this.calculateStats()\r\n  },\r\n  methods: {\r\n    // 检查登录状态\r\n    checkLoginStatus() {\r\n      try {\r\n        const token = uni.getStorageSync('token')\r\n        const userInfo = uni.getStorageSync('userInfo')\r\n\r\n        if (token && userInfo) {\r\n          this.isLoggedIn = true\r\n        } else {\r\n          this.isLoggedIn = false\r\n        }\r\n      } catch (e) {\r\n        console.error('检查登录状态失败', e)\r\n        this.isLoggedIn = false\r\n      }\r\n    },\r\n    // 处理个人信息卡片点击\r\n    handleProfileClick() {\r\n      if (!this.isLoggedIn) {\r\n        this.handleLogin()\r\n      } else {\r\n        this.editProfile()\r\n      }\r\n    },\r\n    // 处理登录\r\n    handleLogin() {\r\n      uni.showModal({\r\n        title: '登录提示',\r\n        content: '需要获取您的微信用户信息以便提供更好的服务，是否允许？',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            this.getUserProfile()\r\n          } else {\r\n            uni.showToast({\r\n              title: '您已取消登录',\r\n              icon: 'none',\r\n              duration: 2000\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 获取用户信息\r\n    getUserProfile() {\r\n      uni.getUserProfile({\r\n        desc: '用于完善用户资料',\r\n        success: (res) => {\r\n          console.log('获取用户信息成功', res.userInfo)\r\n\r\n          // 模拟登录接口调用\r\n          this.mockLogin(res.userInfo)\r\n        },\r\n        fail: (err) => {\r\n          console.error('获取用户信息失败', err)\r\n          uni.showToast({\r\n            title: '获取用户信息失败，请重试',\r\n            icon: 'none',\r\n            duration: 2000\r\n          })\r\n        }\r\n      })\r\n    },\r\n    // 模拟登录接口\r\n    mockLogin(userInfo) {\r\n      // 显示加载提示\r\n      uni.showLoading({\r\n        title: '登录中...'\r\n      })\r\n\r\n      // 模拟网络请求延迟\r\n      setTimeout(() => {\r\n        try {\r\n          // 生成模拟token\r\n          const token = 'mock_token_' + Date.now()\r\n\r\n          // 构造用户信息\r\n          const userData = {\r\n            name: userInfo.nickName,\r\n            avatar: userInfo.avatarUrl,\r\n            phone: '', // 可以后续绑定\r\n            gender: userInfo.gender === 1 ? '男' : userInfo.gender === 2 ? '女' : '未知',\r\n            city: userInfo.city || '未知'\r\n          }\r\n\r\n          // 保存到本地存储\r\n          uni.setStorageSync('token', token)\r\n          uni.setStorageSync('userInfo', JSON.stringify(userData))\r\n\r\n          // 更新登录状态\r\n          this.isLoggedIn = true\r\n          this.userInfo = userData\r\n\r\n          // 加载数据\r\n          this.loadData()\r\n          this.calculateStats()\r\n\r\n          uni.hideLoading()\r\n          uni.showToast({\r\n            title: '登录成功',\r\n            icon: 'success',\r\n            duration: 2000\r\n          })\r\n        } catch (e) {\r\n          console.error('登录失败', e)\r\n          uni.hideLoading()\r\n          uni.showToast({\r\n            title: '登录失败，请重试',\r\n            icon: 'none',\r\n            duration: 2000\r\n          })\r\n        }\r\n      }, 1000)\r\n    },\r\n    loadData() {\r\n      const list = getReservations()\r\n      this.reservations = list\r\n\r\n      // 加载支付记录\r\n      const payments = getPaymentRecords()\r\n      this.paymentRecords = payments\r\n    },\r\n    loadUserInfo() {\r\n      // 从本地存储或API获取用户信息\r\n      try {\r\n        const userInfo = uni.getStorageSync('userInfo')\r\n        if (userInfo) {\r\n          this.userInfo = JSON.parse(userInfo)\r\n        }\r\n      } catch (e) {\r\n        console.error('获取用户信息失败', e)\r\n      }\r\n    },\r\n    calculateStats() {\r\n      // 计算统计数据\r\n      this.stats.totalReservations = this.reservations.length\r\n      this.stats.completedReservations = this.reservations.filter(item => item.status === 'completed').length\r\n\r\n      // 计算总消费\r\n      let totalSpent = 0\r\n      this.paymentRecords.forEach(payment => {\r\n        if (payment.status === 'success') {\r\n          totalSpent += parseFloat(payment.amount)\r\n        }\r\n      })\r\n      this.stats.totalSpent = totalSpent.toFixed(2)\r\n    },\r\n    statusText(status) {\r\n      const mapping = {\r\n        confirmed: '待入场',\r\n        cancelled: '已取消',\r\n        completed: '已完成',\r\n        pending_payment: '待支付'\r\n      }\r\n      return mapping[status] || '处理中'\r\n    },\r\n    paymentStatusText(status) {\r\n      const mapping = {\r\n        success: '支付成功',\r\n        pending: '支付中',\r\n        failed: '支付失败',\r\n        refunded: '已退款'\r\n      }\r\n      return mapping[status] || '未知状态'\r\n    },\r\n    switchTab(tab) {\r\n      this.activeTab = tab\r\n    },\r\n    cancelReservation(id) {\r\n      uni.showModal({\r\n        title: '取消预约',\r\n        content: '确认取消本次预约并释放名额吗？',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            const reservation = updateReservationStatus(id, 'cancelled', (nextReservation) => {\r\n              adjustParkingLotQuota(nextReservation.lotId, 1)\r\n              return nextReservation\r\n            })\r\n            if (reservation) {\r\n              this.loadData()\r\n              this.calculateStats()\r\n              uni.showToast({ title: '已取消', icon: 'none' })\r\n            }\r\n          }\r\n        }\r\n      })\r\n    },\r\n    viewDetail(id) {\r\n      uni.navigateTo({ url: `/pages/reserve/success?id=${id}` })\r\n    },\r\n    editProfile() {\r\n      if (!this.isLoggedIn) {\r\n        this.handleLogin()\r\n        return\r\n      }\r\n      uni.navigateTo({ url: '/pages/user/profile' })\r\n    },\r\n    showSettings() {\r\n      if (!this.isLoggedIn) {\r\n        uni.showToast({\r\n          title: '请先登录',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      this.showSettingsPopup = true\r\n    },\r\n    goToProfile() {\r\n      this.showSettingsPopup = false\r\n      this.editProfile()\r\n    },\r\n    goToPrivacy() {\r\n      this.showSettingsPopup = false\r\n      uni.navigateTo({ url: '/pages/user/privacy' })\r\n    },\r\n    goToAbout() {\r\n      this.showSettingsPopup = false\r\n      uni.navigateTo({ url: '/pages/user/about' })\r\n    },\r\n    goToAdmin() {\r\n      this.showSettingsPopup = false\r\n      uni.navigateTo({ url: '/pages/admin/index' })\r\n    },\r\n    logout() {\r\n      this.showSettingsPopup = false\r\n      uni.showModal({\r\n        title: '退出登录',\r\n        content: '确认退出当前账号吗？',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            // 清除用户信息\r\n            uni.removeStorageSync('userInfo')\r\n            uni.removeStorageSync('token')\r\n\r\n            // 更新登录状态\r\n            this.isLoggedIn = false\r\n            this.userInfo = {\r\n              name: '',\r\n              phone: '',\r\n              avatar: ''\r\n            }\r\n            this.reservations = []\r\n            this.paymentRecords = []\r\n            this.stats = {\r\n              totalReservations: 0,\r\n              totalSpent: 0,\r\n              completedReservations: 0\r\n            }\r\n\r\n            uni.showToast({\r\n              title: '已退出登录',\r\n              icon: 'success'\r\n            })\r\n          }\r\n        }\r\n      })\r\n    },\r\n    requestRefund(id) {\r\n      uni.showModal({\r\n        title: '申请退款',\r\n        content: '确认申请退款吗？',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            const result = requestRefundApi(id)\r\n            if (result) {\r\n              this.loadData()\r\n              uni.showToast({ title: '退款申请已提交', icon: 'success' })\r\n            } else {\r\n              uni.showToast({ title: '退款申请失败', icon: 'none' })\r\n            }\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page {\r\n  min-height: 100vh;\r\n  background: #f3f5f9;\r\n  padding-bottom: 40rpx;\r\n}\r\n\r\n.profile-card {\r\n  padding: 40rpx 30rpx 20rpx;\r\n  background: linear-gradient(180deg, #3D7EFF 0%, #EDF3FF 100%);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  position: relative;\r\n  /* 确保子元素的绝对定位基于此容器 */\r\n}\r\n\r\n.arrow-icon {\r\n  position: absolute;\r\n  right: 20rpx;\r\n  /* 调整箭头距离右侧的间距 */\r\n  top: 50%;\r\n  /* 垂直居中 */\r\n  transform: translateY(-50%);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 50rpx;\r\n  height: 50rpx;\r\n}\r\n\r\n.avatar {\r\n  position: relative;\r\n  width: 96rpx;\r\n  /* 标准头像尺寸 */\r\n  height: 96rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 48rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.profile-info {\r\n  flex: 1;\r\n  margin-left: 24rpx;\r\n  /* 增加头像与信息之间的间距 */\r\n  color: #fff;\r\n  text-align: left;\r\n  /* 左对齐文字，更接近原始风格 */\r\n}\r\n\r\n.greeting {\r\n  font-size: 30rpx;\r\n  font-weight: 600;\r\n  line-height: 34rpx;\r\n}\r\n\r\n.subtext {\r\n  font-size: 22rpx;\r\n  opacity: 0.9;\r\n  margin-top: 8rpx;\r\n}\r\n\r\n.login-btn {\r\n  padding: 12rpx 26rpx;\r\n  background: rgba(255, 255, 255, 0.95);\r\n  border-radius: 18rpx;\r\n  color: #3D7EFF;\r\n  font-size: 26rpx;\r\n  font-weight: 500;\r\n  box-shadow: 0 6rpx 18rpx rgba(61, 126, 255, 0.12);\r\n}\r\n\r\n.stats-section {\r\n  margin: 20rpx 30rpx 0;\r\n  padding: 30rpx;\r\n  background: #fff;\r\n  border-radius: 24rpx;\r\n  box-shadow: 0 8rpx 16rpx rgba(17, 32, 64, 0.06);\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.stats-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  flex: 1;\r\n}\r\n\r\n.stats-value {\r\n  font-size: 36rpx;\r\n  font-weight: 600;\r\n  color: #111;\r\n}\r\n\r\n.stats-label {\r\n  font-size: 24rpx;\r\n  color: #7A8499;\r\n  margin-top: 8rpx;\r\n}\r\n\r\n.filter-bar {\r\n  margin: 30rpx;\r\n  background: #fff;\r\n  border-radius: 24rpx;\r\n  padding: 16rpx;\r\n  box-shadow: 0 12rpx 24rpx rgba(17, 32, 64, 0.04);\r\n  display: flex;\r\n  overflow-x: auto;\r\n\r\n  &::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n}\r\n\r\n.filter-item {\r\n  flex-shrink: 0;\r\n  padding: 12rpx 24rpx;\r\n  font-size: 26rpx;\r\n  color: #7A8499;\r\n  border-radius: 16rpx;\r\n  margin-right: 16rpx;\r\n\r\n  &:last-child {\r\n    margin-right: 0;\r\n  }\r\n\r\n  &.active {\r\n    background: #3D7EFF;\r\n    color: #fff;\r\n  }\r\n}\r\n\r\n.settings-section {\r\n  margin: 30rpx;\r\n  background: #fff;\r\n  border-radius: 24rpx;\r\n  padding: 0 30rpx;\r\n  box-shadow: 0 12rpx 24rpx rgba(17, 32, 64, 0.04);\r\n  position: relative;\r\n  /* 确保子元素的绝对定位基于此容器 */\r\n}\r\n\r\n.settings-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 30rpx 0;\r\n}\r\n\r\n.settings-text {\r\n  flex: 1;\r\n  font-size: 28rpx;\r\n  color: #111;\r\n  margin-left: 20rpx;\r\n}\r\n\r\n.list {\r\n  height: calc(100vh - 520rpx);\r\n  padding: 0 30rpx;\r\n}\r\n\r\n.empty {\r\n  padding: 100rpx 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.empty-image {\r\n  width: 240rpx;\r\n  height: 240rpx;\r\n}\r\n\r\n.empty-text {\r\n  margin-top: 24rpx;\r\n  font-size: 28rpx;\r\n  color: #7A8499;\r\n}\r\n\r\n.reservation-card,\r\n.payment-card {\r\n  margin-top: 24rpx;\r\n  background: #fff;\r\n  border-radius: 24rpx;\r\n  padding: 30rpx;\r\n  box-shadow: 0 12rpx 24rpx rgba(17, 32, 64, 0.04);\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.lot-name,\r\n.payment-title {\r\n  font-size: 30rpx;\r\n  font-weight: 600;\r\n  color: #111;\r\n}\r\n\r\n.amount {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #FF5A5F;\r\n}\r\n\r\n.status {\r\n  font-size: 24rpx;\r\n  padding: 6rpx 16rpx;\r\n  border-radius: 16rpx;\r\n\r\n  &.status-confirmed {\r\n    background: rgba(61, 126, 255, 0.12);\r\n    color: #3D7EFF;\r\n  }\r\n\r\n  &.status-completed {\r\n    background: rgba(82, 196, 26, 0.12);\r\n    color: #52C41A;\r\n  }\r\n\r\n  &.status-cancelled {\r\n    background: rgba(255, 90, 95, 0.12);\r\n    color: #FF5A5F;\r\n  }\r\n\r\n  &.status-pending_payment {\r\n    background: rgba(255, 180, 0, 0.12);\r\n    color: #FFB400;\r\n  }\r\n}\r\n\r\n.card-body {\r\n  margin-top: 24rpx;\r\n  padding-top: 24rpx;\r\n  border-top: 2rpx solid #F0F3FB;\r\n}\r\n\r\n.row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-top: 16rpx;\r\n\r\n  &:first-child {\r\n    margin-top: 0;\r\n  }\r\n}\r\n\r\n.label {\r\n  font-size: 26rpx;\r\n  color: #7A8499;\r\n}\r\n\r\n.value {\r\n  font-size: 26rpx;\r\n  color: #111;\r\n  font-weight: 500;\r\n}\r\n\r\n.card-footer {\r\n  margin-top: 24rpx;\r\n  padding-top: 24rpx;\r\n  border-top: 2rpx solid #F0F3FB;\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 16rpx;\r\n}\r\n\r\n.payment-status {\r\n  font-size: 24rpx;\r\n  padding: 6rpx 16rpx;\r\n  border-radius: 16rpx;\r\n\r\n  &.payment-success {\r\n    background: rgba(82, 196, 26, 0.12);\r\n    color: #52C41A;\r\n  }\r\n\r\n  &.payment-pending {\r\n    background: rgba(255, 180, 0, 0.12);\r\n    color: #FFB400;\r\n  }\r\n\r\n  &.payment-failed {\r\n    background: rgba(255, 90, 95, 0.12);\r\n    color: #FF5A5F;\r\n  }\r\n\r\n  &.payment-refunded {\r\n    background: rgba(17, 144, 255, 0.12);\r\n    color: #1890FF;\r\n  }\r\n}\r\n\r\n.settings-popup {\r\n  padding: 30rpx;\r\n  background: #fff;\r\n  border-radius: 24rpx 24rpx 0 0;\r\n}\r\n\r\n.popup-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.popup-title {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #111;\r\n}\r\n\r\n.settings-list {\r\n  padding: 20rpx 0;\r\n}\r\n\r\n.settings-item {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 24rpx 0;\r\n\r\n  &:not(:last-child) {\r\n    border-bottom: 2rpx solid #F0F3FB;\r\n  }\r\n}\r\n\r\n.settings-label {\r\n  font-size: 28rpx;\r\n  color: #111;\r\n}\r\n</style>","import MiniProgramPage from 'D:/project/park/AutoPark/pages/user/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getReservations","getPaymentRecords","updateReservationStatus","adjustParkingLotQuota","requestRefundApi"],"mappings":"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"}