{"version":3,"file":"MapView.js","sources":["pages/components/MapView.vue","../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovcHJvamVjdC9wYXJrL0F1dG9QYXJrL3BhZ2VzL2NvbXBvbmVudHMvTWFwVmlldy52dWU"],"sourcesContent":["<template>\r\n  <view class=\"map-container\">\r\n    <map\r\n      id=\"map\"\r\n      class=\"map\"\r\n      :latitude=\"latitude\"\r\n      :longitude=\"longitude\"\r\n      :markers=\"mapMarkers\"\r\n      :scale=\"14\"\r\n      @markertap=\"onMarkerTap\"\r\n      @callouttap=\"onCalloutTap\"\r\n    ></map>\r\n    \r\n    <!-- 选中停车场信息卡片 -->\r\n    <view v-if=\"selectedLot\" class=\"map-bottom-card\">\r\n      <view class=\"map-card-header\">\r\n        <text class=\"map-lot-name\">{{ selectedLot.name }}</text>\r\n        <view class=\"map-close\" @click=\"selectedLot = null\">\r\n          <u-icon name=\"close\" size=\"24\" color=\"#7a8499\"></u-icon>\r\n        </view>\r\n      </view>\r\n      \r\n      <view class=\"map-card-body\">\r\n        <view class=\"map-info-row\">\r\n          <text class=\"map-info-label\">地址</text>\r\n          <text class=\"map-info-value\">{{ selectedLot.address }}</text>\r\n        </view>\r\n        <view class=\"map-info-row\">\r\n          <text class=\"map-info-label\">距离</text>\r\n          <text class=\"map-info-value\">{{ formatDistance(selectedLot.distance) }}</text>\r\n        </view>\r\n        <view class=\"map-info-row\">\r\n          <text class=\"map-info-label\">可预约</text>\r\n          <text class=\"map-info-value\">{{ selectedLot.availableQuota }} 个车位</text>\r\n        </view>\r\n        <view class=\"map-info-row\">\r\n          <text class=\"map-info-label\">营业时间</text>\r\n          <text class=\"map-info-value\">{{ selectedLot.businessHours }}</text>\r\n        </view>\r\n      </view>\r\n      \r\n      <view class=\"map-card-footer\">\r\n        <view class=\"map-price\">\r\n          <text class=\"map-price-highlight\">¥{{ selectedLot.pricePerHour }}</text>\r\n          <text class=\"map-price-text\">/小时</text>\r\n        </view>\r\n        <u-button\r\n          type=\"primary\"\r\n          size=\"small\"\r\n          @click=\"goReserve(selectedLot.id)\"\r\n        >立即预约</u-button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'MapView',\r\n  props: {\r\n    latitude: {\r\n      type: Number,\r\n      default: 23.1291\r\n    },\r\n    longitude: {\r\n      type: Number,\r\n      default: 113.2644\r\n    },\r\n    filteredLots: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      selectedLot: null\r\n    }\r\n  },\r\n  computed: {\r\n    mapMarkers() {\r\n      return this.filteredLots.map(lot => {\r\n        return {\r\n          id: lot.id,\r\n          latitude: lot.latitude,\r\n          longitude: lot.longitude,\r\n          width: 30,\r\n          height: 30,\r\n          iconPath: 'https://picsum.photos/seed/marker/30/30.jpg',\r\n          callout: {\r\n            content: lot.name,\r\n            color: '#333',\r\n            fontSize: 12,\r\n            borderRadius: 4,\r\n            bgColor: '#fff',\r\n            padding: 5,\r\n            display: 'ALWAYS'\r\n          }\r\n        }\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    onMarkerTap(e) {\r\n      const markerId = e.detail.markerId\r\n      const lot = this.filteredLots.find(item => item.id === markerId)\r\n      if (lot) {\r\n        this.selectedLot = lot\r\n      }\r\n    },\r\n    onCalloutTap(e) {\r\n      const markerId = e.detail.markerId\r\n      const lot = this.filteredLots.find(item => item.id === markerId)\r\n      if (lot) {\r\n        this.goLotDetail(lot.id)\r\n      }\r\n    },\r\n    goLotDetail(lotId) {\r\n      uni.navigateTo({\r\n        url: `/pages/parking/detail?id=${lotId}`\r\n      })\r\n    },\r\n    goReserve(lotId) {\r\n      uni.navigateTo({\r\n        url: `/pages/reserve/form?lotId=${lotId}`\r\n      })\r\n    },\r\n    formatDistance(distance) {\r\n      if (!distance || distance <= 0) {\r\n        return '未知距离'\r\n      }\r\n      if (distance < 1) {\r\n        return `${Math.round(distance * 1000)} 米`\r\n      }\r\n      return `${distance.toFixed(1)} 公里`\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.map-container {\r\n  position: relative;\r\n  height: calc(100vh - 360rpx);\r\n}\r\n\r\n.map {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.map-bottom-card {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: #fff;\r\n  border-radius: 24rpx 24rpx 0 0;\r\n  padding: 32rpx;\r\n  box-shadow: 0 -8rpx 24rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.map-card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.map-lot-name {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #111;\r\n}\r\n\r\n.map-close {\r\n  width: 48rpx;\r\n  height: 48rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 50%;\r\n  background: #f0f3fb;\r\n}\r\n\r\n.map-card-body {\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.map-info-row {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.map-info-label {\r\n  font-size: 26rpx;\r\n  color: #7a8499;\r\n  width: 120rpx;\r\n}\r\n\r\n.map-info-value {\r\n  font-size: 26rpx;\r\n  color: #111;\r\n  flex: 1;\r\n}\r\n\r\n.map-card-footer {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.map-price {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.map-price-highlight {\r\n  font-size: 34rpx;\r\n  color: #ffb400;\r\n  font-weight: 600;\r\n}\r\n\r\n.map-price-text {\r\n  font-size: 24rpx;\r\n  color: #7a8499;\r\n  margin-left: 6rpx;\r\n}\r\n</style>","import Component from 'D:/project/park/AutoPark/pages/components/MapView.vue'\nwx.createComponent(Component)"],"names":["uni"],"mappings":";;AAyDA,MAAK,YAAU;AAAA,EACb,MAAM;AAAA,EACN,OAAO;AAAA,IACL,UAAU;AAAA,MACR,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,WAAW;AAAA,MACT,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,cAAc;AAAA,MACZ,MAAM;AAAA,MACN,SAAS,MAAM,CAAC;AAAA,IAClB;AAAA,EACD;AAAA,EACD,OAAO;AACL,WAAO;AAAA,MACL,aAAa;AAAA,IACf;AAAA,EACD;AAAA,EACD,UAAU;AAAA,IACR,aAAa;AACX,aAAO,KAAK,aAAa,IAAI,SAAO;AAClC,eAAO;AAAA,UACL,IAAI,IAAI;AAAA,UACR,UAAU,IAAI;AAAA,UACd,WAAW,IAAI;AAAA,UACf,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,UAAU;AAAA,UACV,SAAS;AAAA,YACP,SAAS,IAAI;AAAA,YACb,OAAO;AAAA,YACP,UAAU;AAAA,YACV,cAAc;AAAA,YACd,SAAS;AAAA,YACT,SAAS;AAAA,YACT,SAAS;AAAA,UACX;AAAA,QACF;AAAA,OACD;AAAA,IACH;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,YAAY,GAAG;AACb,YAAM,WAAW,EAAE,OAAO;AAC1B,YAAM,MAAM,KAAK,aAAa,KAAK,UAAQ,KAAK,OAAO,QAAQ;AAC/D,UAAI,KAAK;AACP,aAAK,cAAc;AAAA,MACrB;AAAA,IACD;AAAA,IACD,aAAa,GAAG;AACd,YAAM,WAAW,EAAE,OAAO;AAC1B,YAAM,MAAM,KAAK,aAAa,KAAK,UAAQ,KAAK,OAAO,QAAQ;AAC/D,UAAI,KAAK;AACP,aAAK,YAAY,IAAI,EAAE;AAAA,MACzB;AAAA,IACD;AAAA,IACD,YAAY,OAAO;AACjBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,4BAA4B,KAAK;AAAA,OACvC;AAAA,IACF;AAAA,IACD,UAAU,OAAO;AACfA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,6BAA6B,KAAK;AAAA,OACxC;AAAA,IACF;AAAA,IACD,eAAe,UAAU;AACvB,UAAI,CAAC,YAAY,YAAY,GAAG;AAC9B,eAAO;AAAA,MACT;AACA,UAAI,WAAW,GAAG;AAChB,eAAO,GAAG,KAAK,MAAM,WAAW,GAAI,CAAC;AAAA,MACvC;AACA,aAAO,GAAG,SAAS,QAAQ,CAAC,CAAC;AAAA,IAC/B;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvIA,GAAG,gBAAgB,SAAS;"}